# SCOTUS AI Model Configuration - Optimized with Optuna
# Study: scotus_optimization_20250704_074324
# Best trial: 51
# Best combined metric (Loss + (1-F1))/2: 0.320278
# Optimization date: 2025-07-04T19:52:46.562193
# Note: Optimized using combined KL Divergence Loss and F1-Score Macro

# Hyperparameters studied: 
#   - LEARNING_RATE
#   - WEIGHT_DECAY
#   - FIRST_UNFREEZE_EPOCH
#   - SECOND_UNFREEZE_EPOCH
#   - INITIAL_LAYERS_TO_UNFREEZE
#   - LR_REDUCTION_FACTOR
#   - REDUCE_MAIN_LR_ON_UNFREEZE

# Model Architecture
BIO_MODEL_NAME=sentence-transformers/all-MiniLM-L6-v2
DESCRIPTION_MODEL_NAME=Stern5497/sbert-legal-xlm-roberta-base
EMBEDDING_DIM=384
HIDDEN_DIM=768
MAX_JUSTICES=15

# Attention Mechanism
USE_JUSTICE_ATTENTION=true
NUM_ATTENTION_HEADS=16

# Regularization
DROPOUT_RATE=0.3
WEIGHT_DECAY=0.005918167723844435

# Training Configuration
LEARNING_RATE=0.00023973420779134627
NUM_EPOCHS=10
BATCH_SIZE=16
NUM_WORKERS=0

# Loss Function
LOSS_FUNCTION=kl_div
KL_REDUCTION=batchmean

# Other parameters (kept from base config)
PATIENCE=5
LR_SCHEDULER_FACTOR=0.5
LR_SCHEDULER_PATIENCE=3
MAX_GRAD_NORM=1.0
DEVICE=cuda

# Data Paths
DATASET_FILE=data/processed/case_dataset.json
BIO_TOKENIZED_FILE=data/processed/encoded_bios.pkl
DESCRIPTION_TOKENIZED_FILE=data/processed/encoded_descriptions.pkl

# Output Paths
MODEL_OUTPUT_DIR=models_output
BEST_MODEL_NAME=best_model.pth

# Dataset Splitting
TRAIN_RATIO=0.7
VAL_RATIO=0.15
TEST_RATIO=0.15
SPLIT_RANDOM_STATE=42

# Validation and Evaluation
VALIDATION_FREQUENCY=10
EVALUATE_ON_TEST=true

# Logging and Progress
VERBOSE_TRAINING=true
LOG_FREQUENCY=10

# Memory Management
CLEAR_CACHE_ON_OOM=true

# Model Saving
SAVE_CHECKPOINTS=true
CHECKPOINT_FREQUENCY=5

# Cross-Attention Specific
USE_ATTENTION_FFN=true
ATTENTION_FFN_MULTIPLIER=2

# Advanced Training
USE_MIXED_PRECISION=false
GRADIENT_ACCUMULATION_STEPS=1

# Three-Step Fine-tuning Strategy (Optimized)
FIRST_UNFREEZE_EPOCH=-1
SECOND_UNFREEZE_EPOCH=4
INITIAL_LAYERS_TO_UNFREEZE=4
LR_REDUCTION_FACTOR=0.4
REDUCE_MAIN_LR_ON_UNFREEZE=true

# Random Seeds
RANDOM_SEED=42
TORCH_SEED=42
NUMPY_SEED=42

# Model Loading and Caching
USE_MODEL_CACHE=true
DOWNLOAD_MODELS=true

# Data Validation
MIN_JUSTICES_PER_CASE=1
MAX_JUSTICES_PER_CASE=15
SKIP_MISSING_DESCRIPTIONS=true
SKIP_MISSING_BIOGRAPHIES=true